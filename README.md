# Fine-Tuning Whisper ASR for Romanization
This project contains scripts to process the Kokoro speech dataset for Japanese romanization fine-tuning of ASR models.   
**Currently, the repository contains all preprocessing steps; fine-tuning scripts will be added later.**
****
## Pipeline
1. Run `make_initial_csv.py` to generate the initial CSV from raw metadata.
2. Run `data_cleaning.py` to produce tokenized, normalized, and romaji txts.
3. Manually download relevant mp3 files and place them in `tiny/mp3s/`.
4. Run `convert_mp3s_to_wavs.py` to generate wav files in `tiny/wavs/`.
5. Run MFA (via Docker) with tokenized kana txts and wav files to produce TextGrids in `tiny/timestamps/`.
6. Run `splitwavs.py` to produce aligned wav slices in `tiny/slices/`.
7. Run `make_final_csv.py` to produce `tiny/data.csv` for model training.
    ### Notes
   - Original Kokoro extract.py failed; mp3s had to be downloaded manually.
     - `tiny/mp3s/` must be manually populated with mp3 files. 
   - MFA commands were run locally in Docker and are not saved.
     - `tiny/timestamps/` must be manually populated with MFA TextGrids.

****
## Folder Structure
- data_cleaning.py
  - generates text files (romaji, tokenized kana, normalized kana)
- make_initial_csv.py
  - makes full CSV using metadata txts from Kokoro-Speech-Dataset/data
- convert_mp3s_to_wavs.py
  - converts manually downloaded mp3 files to wav files
- make_final_csv.py
  - makes CSV with addresses of split wav files and the respective normalized romaji transcripts
- splitwavs.py
  - splits wav files by timestamps for each line in text
- tiny/  
  - mp3s/            
    - manually created, place mp3 files here  
  - timestamps/      
    - manually created, place MFA TextGrids here  
  - wavs/            
    - auto-generated by convert_mp3s_to_wavs.py  
  - tokenized_txts/  
    - auto-generated by data_cleaning.py  
  - normalized_txts/ 
    - auto-generated by data_cleaning.py  
  - romaji_txts/     
    - auto-generated by data_cleaning.py  
  - slices/          
    - auto-generated by splitwavs.py  
  - data.csv         
    - auto-generated by make_final_csv.py  

